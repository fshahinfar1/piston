python ./main.py --batch 1 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.12it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 1
Req 512 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 511 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 510 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 509 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 508 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 507 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 506 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 505 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 504 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 503 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 502 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 501 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 500 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 499 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 498 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 497 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 496 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 495 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 494 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 493 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 492 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 491 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 490 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 489 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 488 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 487 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 486 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 485 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 484 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 483 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 482 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 481 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 480 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 479 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 478 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 477 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 476 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 475 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 474 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 473 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 472 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 471 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 470 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 469 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 468 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 467 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 466 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 465 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 464 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 463 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 462 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 461 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 460 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 459 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 458 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 457 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 456 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 455 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 454 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 453 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 452 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 451 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 450 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 449 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 448 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 447 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 446 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 445 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 444 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 443 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 442 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 441 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 440 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 439 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 438 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 437 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 436 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 435 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 434 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 433 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 432 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 431 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 430 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 429 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 428 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 427 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 426 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 425 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 424 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 423 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 422 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 421 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 420 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 419 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 418 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 417 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 416 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 415 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 414 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 413 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 412 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 411 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 410 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 409 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 408 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 407 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 406 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 405 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 404 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 403 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 402 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 401 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 400 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 399 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 398 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 397 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 396 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 395 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 394 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 393 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 392 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 391 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 390 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 389 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 388 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 387 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 386 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 385 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 384 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 383 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 382 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 381 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 380 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 379 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 378 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 377 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 376 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 375 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 374 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 373 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 372 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 371 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 370 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 369 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 368 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 367 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 366 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 365 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 364 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 363 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 362 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 361 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 360 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 359 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 358 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 357 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 356 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 355 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 354 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 353 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 352 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 351 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 350 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 349 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 348 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 347 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 346 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 345 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 344 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 343 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 342 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 341 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 340 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 339 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 338 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 337 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 336 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 335 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 334 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 333 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 332 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 331 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 330 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 329 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 328 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 327 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 326 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 325 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 324 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 323 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 322 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 321 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 320 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 319 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 318 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 317 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 316 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 315 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 314 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 313 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 312 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 311 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 310 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 309 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 308 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 307 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 306 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 305 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 304 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 303 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 302 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 301 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 300 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 299 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 298 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 297 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 296 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 295 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 294 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 293 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 292 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 291 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 290 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 289 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 288 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 287 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 286 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 285 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 284 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 283 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 282 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 281 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 280 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 279 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 278 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 277 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 276 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 275 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 274 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 273 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 272 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 271 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 270 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 269 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 268 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 267 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 266 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 265 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 264 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 263 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 262 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 261 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 260 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 259 size: 15728640 number of tokens: 40 (shape: torch.Size([1, 32, 40, 96]))
Req 258 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Req 257 size: 14548992 number of tokens: 37 (shape: torch.Size([1, 32, 37, 96]))
Time to process 256 requests: 282.07 seconds
------------------------------
python ./main.py --batch 2 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.86it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 2
Req 384 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 383 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 382 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 381 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 380 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 379 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 378 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 377 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 376 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 375 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 374 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 373 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 372 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 371 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 370 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 369 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 368 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 367 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 366 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 365 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 364 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 363 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 362 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 361 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 360 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 359 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 358 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 357 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 356 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 355 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 354 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 353 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 352 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 351 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 350 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 349 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 348 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 347 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 346 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 345 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 344 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 343 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 342 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 341 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 340 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 339 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 338 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 337 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 336 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 335 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 334 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 333 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 332 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 331 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 330 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 329 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 328 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 327 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 326 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 325 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 324 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 323 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 322 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 321 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 320 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 319 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 318 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 317 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 316 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 315 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 314 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 313 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 312 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 311 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 310 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 309 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 308 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 307 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 306 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 305 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 304 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 303 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 302 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 301 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 300 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 299 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 298 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 297 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 296 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 295 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 294 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 293 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 292 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 291 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 290 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 289 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 288 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 287 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 286 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 285 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 284 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 283 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 282 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 281 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 280 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 279 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 278 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 277 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 276 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 275 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 274 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 273 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 272 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 271 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 270 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 269 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 268 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 267 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 266 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 265 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 264 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 263 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 262 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 261 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 260 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Req 259 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 258 size: 31457280 number of tokens: 40 (shape: torch.Size([2, 32, 40, 96]))
Req 257 size: 29097984 number of tokens: 37 (shape: torch.Size([2, 32, 37, 96]))
Time to process 256 requests: 153.81 seconds
------------------------------
python ./main.py --batch 4 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.18it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 4
Req 320 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 319 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 318 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 317 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 316 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 315 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 314 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 313 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 312 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 311 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 310 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 309 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 308 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 307 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 306 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 305 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 304 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 303 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 302 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 301 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 300 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 299 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 298 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 297 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 296 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 295 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 294 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 293 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 292 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 291 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 290 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 289 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 288 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 287 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 286 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 285 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 284 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 283 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 282 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 281 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 280 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 279 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 278 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 277 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 276 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 275 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 274 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 273 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 272 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 271 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 270 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 269 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 268 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 267 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 266 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 265 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 264 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 263 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 262 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 261 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 260 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 259 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 258 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Req 257 size: 62914560 number of tokens: 40 (shape: torch.Size([4, 32, 40, 96]))
Time to process 256 requests: 80.72 seconds
------------------------------
python ./main.py --batch 8 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.24it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 8
Req 288 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 287 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 286 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 285 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 284 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 283 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 282 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 281 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 280 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 279 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 278 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 277 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 276 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 275 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 274 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 273 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 272 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 271 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 270 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 269 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 268 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 267 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 266 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 265 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 264 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 263 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 262 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 261 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 260 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 259 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 258 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Req 257 size: 125829120 number of tokens: 40 (shape: torch.Size([8, 32, 40, 96]))
Time to process 256 requests: 42.18 seconds
------------------------------
python ./main.py --batch 16 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.27it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 16
Req 272 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 271 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 270 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 269 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 268 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 267 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 266 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 265 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 264 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 263 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 262 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 261 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 260 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 259 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 258 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Req 257 size: 251658240 number of tokens: 40 (shape: torch.Size([16, 32, 40, 96]))
Time to process 256 requests: 23.56 seconds
------------------------------
python ./main.py --batch 32 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.35it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 32
Req 264 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 263 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 262 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 261 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 260 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 259 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 258 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Req 257 size: 503316480 number of tokens: 40 (shape: torch.Size([32, 32, 40, 96]))
Time to process 256 requests: 14.50 seconds
------------------------------
python ./main.py --batch 64 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.36it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 64
Req 260 size: 1006632960 number of tokens: 40 (shape: torch.Size([64, 32, 40, 96]))
Req 259 size: 1006632960 number of tokens: 40 (shape: torch.Size([64, 32, 40, 96]))
Req 258 size: 1006632960 number of tokens: 40 (shape: torch.Size([64, 32, 40, 96]))
Req 257 size: 1006632960 number of tokens: 40 (shape: torch.Size([64, 32, 40, 96]))
Time to process 256 requests: 8.63 seconds
------------------------------
python ./main.py --batch 128 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.37it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 128
Req 258 size: 2013265920 number of tokens: 40 (shape: torch.Size([128, 32, 40, 96]))
Req 257 size: 2013265920 number of tokens: 40 (shape: torch.Size([128, 32, 40, 96]))
Time to process 256 requests: 5.97 seconds
------------------------------
python ./main.py --batch 256 --num-requests 256 --pipeline simple --num-stages 1 --iters 32
Running experiment with pipeline mode: simple
Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.99it/s]
Loaded. Model size: 7642159296
loading: 0
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
cuda:0 : Memory usage: 7642421248
Processing a pile of 256 requests
Batch size is: 256
Req 257 size: 4026531840 number of tokens: 40 (shape: torch.Size([256, 32, 40, 96]))
Time to process 256 requests: 5.68 seconds
------------------------------
Done